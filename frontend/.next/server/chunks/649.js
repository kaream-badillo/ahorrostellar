"use strict";exports.id=649,exports.ids=[649],exports.modules={3125:(a,b,c)=>{c.d(b,{A:()=>x});var d=c(28625),e=c(64996),f=c(11332),g=c(43785),h=c(93948),i=c.n(h),j=c(61299),k=c(14502),l=c.n(k);async function m(){if(void 0===window.freighterApi)throw Error("Freighter no detectada. Verifica extensi\xf3n y permisos de sitio.");if(!(await l().isConnected()).isConnected)throw Error("Freighter no conectada");if(!(await l().setAllowed()).isAllowed)throw Error("Permiso denegado");let a=await l().getAddress();if(a.address)return a.address;let b=await l().requestAccess();if(b.error||!b.address)throw Error(b.error||"Sin address");return b.address}function n(){let[a,b]=(0,e.useState)(),[c,f]=(0,e.useState)(!1),[g,h]=(0,e.useState)(),i=async()=>{f(!0),h(void 0);try{let a=await m();b(a)}catch(b){let a=b instanceof Error?b.message:"Error desconocido";if(a.includes("Freighter no detectada"))return void window.open("https://freighter.app/","_blank");h(a)}finally{f(!1)}};return a?(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsxs)("div",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[a.slice(0,4),"…",a.slice(-4)]}),(0,d.jsx)("button",{onClick:()=>{b(void 0),h(void 0)},className:"text-xs text-red-600 hover:text-red-700",children:"Desconectar"})]}):(0,d.jsxs)("div",{className:"flex flex-col items-end space-y-2",children:[(0,d.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50",onClick:i,disabled:c,children:c?"Conectando...":"Connect Wallet"}),g&&(0,d.jsx)("p",{className:"text-xs text-red-600 text-right max-w-xs",children:g})]})}var o=c(63404);function p({showSearch:a=!0}){let{state:b,clearNotifications:c}=(0,j.n)(),{user:e,notifications:h}=b;return(0,d.jsx)("header",{className:"bg-white/90 backdrop-blur-sm border-b border-stellar-100 sticky top-0 z-50",children:(0,d.jsx)("div",{className:"max-w-screen-xl mx-auto px-8 py-4",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(i(),{href:"/",className:"flex items-center space-x-3",children:[(0,d.jsx)(o.default,{src:"/favicon.png",alt:"Stellar Logo",width:32,height:32,className:"w-8 h-8"}),(0,d.jsx)("span",{className:"text-2xl font-bold gradient-text",children:"AhorroStellar"})]}),a&&(0,d.jsx)("div",{className:"flex-1 max-w-md mx-8",children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,d.jsx)("input",{type:"text",placeholder:"Search projects, users...",className:"w-full pl-10 pr-4 py-2 border border-stellar-100 rounded-lg focus:ring-2 focus:ring-stellarBlue focus:border-transparent"})]})}),(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsxs)("button",{className:"p-3 rounded-lg hover:bg-stellar-100 transition-colors relative",onClick:c,children:[(0,d.jsx)(g.A,{className:"w-6 h-6 text-gray-600"}),h>0&&(0,d.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center",children:h})]}),(0,d.jsx)(n,{})]})]})})})}var q=c(83990),r=c(8205),s=c(74241),t=c(42097),u=c(86389),v=c(11107);function w(){let a=(0,v.usePathname)(),{state:b,disconnectWallet:c}=(0,j.n)(),{user:e,wallet:f}=b,g=[{name:"Dashboard",href:"/dashboard",icon:q.A},{name:"Vote-Save",href:"/stake",icon:r.A},{name:"Reflector Debug",href:"/reflector-debug",icon:s.A}];return(0,d.jsx)("aside",{className:"w-72 bg-white/80 backdrop-blur-sm border-r border-gray-200 sticky top-16 h-screen overflow-y-auto hidden lg:block",children:(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)("nav",{className:"space-y-2 mb-8",children:g.map(b=>{let c=b.icon;return(0,d.jsxs)(i(),{href:b.href,className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${a===b.href?"bg-blue-100 text-blue-700 font-medium shadow-sm":"hover:bg-blue-50 text-gray-600 hover:text-blue-700"}`,children:[(0,d.jsx)(c,{className:"w-5 h-5"}),(0,d.jsx)("span",{children:b.name})]},b.name)})}),(0,d.jsxs)("div",{className:"space-y-4 mb-8",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Quick Summary"}),(0,d.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600",children:"USDC Bloqueados"}),(0,d.jsxs)("span",{className:"text-sm font-semibold text-blue-600",children:[e?.activeStakes||"0"," USDC"]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600",children:"Backed Projects"}),(0,d.jsx)("span",{className:"text-sm font-semibold text-green-600",children:b.myStakedProjects.length})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600",children:"Reputation"}),(0,d.jsx)("span",{className:"text-sm font-semibold text-purple-600",children:e?.reputationLevel||"Bronze"})]})]})]}),(0,d.jsxs)("div",{className:"space-y-3 mb-8",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Security"}),(0,d.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,d.jsx)(t.A,{className:"w-4 h-4 text-green-600"}),(0,d.jsx)("span",{className:"text-sm font-medium text-green-700",children:"Your savings are safe"})]}),(0,d.jsxs)("div",{className:"space-y-1 text-xs text-green-600",children:[(0,d.jsx)("p",{children:"• USDC se bloquea por 7 d\xedas"}),(0,d.jsx)("p",{children:"• Se recupera autom\xe1ticamente"}),(0,d.jsx)("p",{children:"• Sin riesgo de p\xe9rdida"})]})]})]}),(0,d.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,d.jsx)("div",{className:"space-y-2",children:(0,d.jsxs)("button",{onClick:()=>{c()},className:"flex items-center space-x-3 px-4 py-3 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors w-full",children:[(0,d.jsx)(u.A,{className:"w-5 h-5"}),(0,d.jsx)("span",{children:"Sign Out"})]})})})]})})}function x({children:a,showSidebar:b=!0,showSearch:c=!0}){return(0,d.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-light to-white",children:[(0,d.jsx)(p,{showSearch:c}),(0,d.jsxs)("div",{className:"flex",children:[b&&(0,d.jsx)(w,{}),(0,d.jsx)("main",{className:"flex-1 p-4 lg:p-8",children:(0,d.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:a})})]})]})}},27273:(a,b,c)=>{c.d(b,{n7:()=>u,FN:()=>s,to:()=>t,yA:()=>r,priceUSDCinUSD:()=>o,priceXLMinUSD:()=>q,Mj:()=>v,usdPerCLP:()=>p});var d=c(42730);let e="Test SDF Network ; September 2015",f="CAVLP5DH2GJPZMVO7IJY4CVOD5MWEFTJFVPD2YY2FQXOQHRGHK4D6HLP",g="CCSSOHTBL3LEWUCBBEB5NJFC2OKFRC74OWEIJIZLRJBGAAU4VMU5NV4W",h="CCYOZJCOPG34LLQQ7N24YXBM7LL62R7ONMZ3G6WZAAYPB5OYKOMJRN63",i=new d.rpc.Server("https://soroban-testnet.stellar.org",{allowHttp:!0}),j=14;var k=function(a){return a[a.Stellar=1]="Stellar",a[a.Other=2]="Other",a}(k||{});function l(a){let b=null;switch(a.type){case 1:{let c=a.code.split(":");if(2===c.length){let[a,e]=c;if(!a||!e)throw Error("Asset code and issuer must be defined");if(!d.StrKey.isValidEd25519PublicKey(e))throw Error("Asset issuer must be a valid ed25519 public key");b=new d.Asset(a,e)}else if("XLM"===a.code)b=d.Asset.native();else{if(!d.StrKey.isValidContract(a.code))throw Error(`Asset code ${a.code} is invalid contract ID`);return new d.Address(a.code).toScVal()}break}case 2:let c;if(a.code.length>32)throw Error("Asset code must be 32 characters or less");return c=a.code,d.xdr.ScVal.scvSymbol(c);default:throw Error(`Asset type ${a.type} is not supported`)}if(b){let a=new d.xdr.HashIdPreimageContractId({networkId:(0,d.hash)(Buffer.from(e)),contractIdPreimage:d.xdr.ContractIdPreimage.contractIdPreimageFromAsset(b.toXDRObject())}),c=d.xdr.HashIdPreimage.envelopeTypeContractId(a),f=d.StrKey.encodeContract((0,d.hash)(c.toXDR()));return new d.Address(f).toScVal()}throw Error("Failed to build asset ScVal")}async function m(a,b,c){try{let k=function(){let a="GCW225D7H6JQBEM7XVKE2AX7KGPVI3FPU3SS6A2MQMZTXNY6KDGZNSEX";return a?d.StrKey.isValidEd25519PublicKey(a)?(console.log("Using real Reflector account:",a.slice(0,6)+"..."+a.slice(-6)),a):(console.warn("Invalid public key format, using demo key"),"GDEMO123456789012345678901234567890123456789012345678901234567890"):(console.warn("NEXT_PUBLIC_READONLY_PUBLIC_KEY not configured, using demo key"),"GDEMO123456789012345678901234567890123456789012345678901234567890")}();if(k.startsWith("GDEMO")){if(console.warn("\uD83D\uDD27 DEMO MODE: Using fallback prices (configure .env.local for real Reflector)"),"lastprice"===b){if(a===f)return 1;if(a===h)return .12}if("x_last_price"===b){if(a===g)return 1e3;if(a===h)return .12}if("decimals"===b)return 14;if("last_timestamp"===b)return Math.floor(Date.now()/1e3);return 1}console.log("\uD83D\uDE80 REAL REFLECTOR: Fetching live prices from Oracle");let l=await i.getAccount(k),m=new d.Contract(a),n=new d.TransactionBuilder(l,{fee:d.BASE_FEE,networkPassphrase:e}).addOperation(m.call(b,...c)).setTimeout(30).build(),o=await i.simulateTransaction(n);if(d.rpc.Api.isSimulationError(o))throw Error(`Simulation error: ${o.error}`);let p=o.result?.retval??o.result;if(!p)throw Error("No retval from simulation");let q=(0,d.scValToBigInt)(p);return((a,b=j)=>Number(a)/10**b)(q)}catch(c){if(console.error(`Error in simulateRead(${a}, ${b}):`,c),c instanceof Error&&(c.message.includes("Account not found")||c.message.includes("invalid checksum"))){if(console.warn("Account error detected, falling back to demo prices"),"lastprice"===b){if(a===f)return 1;if(a===h)return .12}if("x_last_price"===b){if(a===g)return 1e3;if(a===h)return .12}if("decimals"===b)return 14;if("last_timestamp"===b)return Math.floor(Date.now()/1e3);return 1}throw c}}async function n(a){try{let b=await m(a,"decimals",[]);return Math.floor(b)}catch(b){return console.warn(`Failed to get decimals for ${a}, using default ${j}`),j}}async function o(){try{return await m(f,"lastprice",[l({type:2,code:"USDC"})])}catch(a){return console.error("Failed to get USDC/USD price:",a),1}}async function p(){try{return await m(g,"x_last_price",[l({type:2,code:"USD"}),l({type:2,code:"CLP"})])}catch(a){return console.error("Failed to get USD/CLP rate:",a),1e3}}async function q(){try{return await m(h,"x_last_price",[l({type:1,code:"XLM"}),l({type:2,code:"USD"})])}catch(a){return console.error("Failed to get XLM/USD price:",a),.12}}async function r(){try{let a=await p();return 1/a}catch(a){return console.error("Failed to get CLP/USD price:",a),.001}}async function s(a,b,c=2){try{return await m(a,"twap",[l(b),d.xdr.ScVal.scvU32(c)])}catch(a){throw console.error(`Failed to get TWAP for ${b.code}:`,a),a}}async function t(a,b,c,e=2){try{return await m(a,"x_twap",[l(b),l(c),d.xdr.ScVal.scvU32(e)])}catch(a){throw console.error(`Failed to get X-TWAP for ${b.code}/${c.code}:`,a),a}}async function u(a){try{let b=await m(a,"last_timestamp",[]);return Math.floor(b)}catch(b){throw console.error(`Failed to get last timestamp for ${a}:`,b),b}}async function v(){let a={usdcUsd:{price:0,error:null,timestamp:Date.now()},usdClp:{price:0,error:null,timestamp:Date.now()},xlmUsd:{price:0,error:null,timestamp:Date.now()},clpUsd:{price:0,error:null,timestamp:Date.now()},decimals:{usdc:0,fx:0,cex:0,errors:[]},lastTimestamps:{usdc:0,fx:0,cex:0,errors:[]},twaps:{usdc:0,xlm:0,errors:[]}};try{a.usdcUsd.price=await o()}catch(b){a.usdcUsd.error=b instanceof Error?b.message:"Unknown error"}try{a.usdClp.price=await p()}catch(b){a.usdClp.error=b instanceof Error?b.message:"Unknown error"}try{a.xlmUsd.price=await q()}catch(b){a.xlmUsd.error=b instanceof Error?b.message:"Unknown error"}try{a.clpUsd.price=await r()}catch(b){a.clpUsd.error=b instanceof Error?b.message:"Unknown error"}try{a.decimals.usdc=await n(f),a.decimals.fx=await n(g),a.decimals.cex=await n(h)}catch(b){a.decimals.errors.push(b instanceof Error?b.message:"Unknown error")}try{a.lastTimestamps.usdc=await u(f),a.lastTimestamps.fx=await u(g),a.lastTimestamps.cex=await u(h)}catch(b){a.lastTimestamps.errors.push(b instanceof Error?b.message:"Unknown error")}try{a.twaps.usdc=await s(f,{type:2,code:"USDC"},2),a.twaps.xlm=await s(h,{type:1,code:"XLM"},2)}catch(b){a.twaps.errors.push(b instanceof Error?b.message:"Unknown error")}return a}},52805:(a,b,c)=>{c.d(b,{A:()=>i});var d=c(28625),e=c(64996),f=c.n(e),g=c(37284);let h=f().forwardRef(({className:a,variant:b="default",children:c,...e},f)=>(0,d.jsx)("div",{className:(0,g.cn)("card-stellar rounded-xl shadow-lg border border-stellar-100/50",{default:"bg-white/80 backdrop-blur-sm",glass:"bg-white/10 backdrop-blur-md border-white/20",gradient:"bg-gradient-to-br from-white/90 to-white/70"}[b],a),ref:f,...e,children:c}));h.displayName="Card";let i=h}};